<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin • Đăng truyện</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .modal[hidden] {
  display: none !important;
}

  </style>
</head>

<body data-page="admin">
  <header class="topbar">
    <a class="btn" href="index.html">← Về trang chủ</a>
    <h1>✍️ Khu vực Admin</h1>
    <button id="logoutBtn" class="btn subtle">Đăng xuất</button>
  </header>
  <main class="container">
    <div id="adminGuard" class="warn">Đang kiểm tra quyền truy cập...</div>

    <!-- Tạo truyện -->
<section id="createStory" class="card" hidden>
  <h2>Thêm truyện mới</h2>

  <!-- Link nguồn
  <label>Link truyện (nguồn)
    <input id="storyLink" type="url" placeholder="Dán link truyện ở đây" />
  </label>
  <button id="fetchDataBtn" class="btn subtle">📥 Lấy dữ liệu từ link</button> -->
  <input type="text" id="storyLink" placeholder="Link gốc (tùy chọn)">


  <!-- Tiêu đề -->
  <label>Tiêu đề
    <input id="storyTitle" required />
  </label>

  <!-- Mô tả -->
  <label>Mô tả
    <textarea id="storyDesc" rows="3"></textarea>
  </label>

  <!-- Ảnh bìa -->
  <label>Ảnh bìa (URL)
    <input id="storyCoverUrl" type="text" placeholder="Dán link ảnh bìa vào đây" />
  </label>

  <button id="createStoryBtn" class="btn">Tạo truyện</button>
</section>


    <!-- Thêm chương -->
    <section id="manageChapters" class="card" hidden>
      <h2>Thêm chương</h2>
      <label>Chọn truyện
        <select id="storySelect"></select>
      </label>
      <label>Tiêu đề chương
        <input id="chapterTitle" />
      </label>
      <label>Nội dung chương
        <textarea id="chapterContent" rows="8"></textarea>
      </label>
      <button id="addChapterBtn" class="btn">Thêm chương</button>
    </section>
    <hr>
  
<hr>

   <!-- Danh sách truyện -->
<section id="manageStories" class="card" hidden>
  <h2>Danh sách truyện</h2>
  <div id="storyList">
  </div>
</section>
<!-- Gửi thư -->
<section id="sendMailSection" class="card">
  <h2>📩 Gửi thư đến người dùng</h2>
  <label>Tiêu đề
    <input id="mailSubject" type="text" placeholder="Nhập tiêu đề..." />
  </label>
  <label>Nội dung
    <textarea id="mailBody" rows="5" placeholder="Nhập nội dung thư..."></textarea>
  </label>
  <button id="sendMailBtn" class="btn">Gửi thư</button>
</section>
  
<hr>
<!-- Sửa chương -->
<section id="editChapterSection" class="card" hidden>
  <h2>Quản Lý Truyện</h2>
  <label>Chọn truyện
    <select id="storySelectEdit"></select>
  </label>
  <label>Chọn chương
    <select id="chapterSelect"></select>
  </label>
  <label>Tiêu đề chương
    <input id="editChapterTitle" />
  </label>
  <label>Nội dung chương
    <textarea id="editChapterContent" rows="8"></textarea>
  </label>
  <button id="saveChapterEditBtn" class="btn">Lưu thay đổi</button>
  <button id="deleteBtn" class="btn btn-danger">🗑️ Xóa</button>
  <button id="cancelChapterEditBtn" class="btn subtle">Hủy</button>
</section>

    <dialog id="updateSuccessModal">
  <h3>✅ Cập nhật thành công!</h3>
  <p>Chương đã được lưu vào cơ sở dữ liệu.</p>
  <button id="closeModalBtn" class="btn">Đóng</button>
</dialog>
<!-- Modal thông báo -->
<div id="modalBox" class="modal hidden">
  <div class="modal-content">
    <p id="modalMessage"></p>
    <button id="modalClose">Đóng</button>
  </div>
</div>

<!-- Modal xác nhận -->
<div id="confirmBox" class="modal hidden">
  <div class="modal-content">
    <p id="confirmMessage"></p>
    <div class="actions">
      <button id="confirmYes">OK</button>
      <button id="confirmNo">Hủy</button>
    </div>
  </div>
</div>
<!-- Modal cảnh báo quyền truy cập -->
<div id="noAccessModal" class="modal" hidden>
  <div class="modal-content">
    <h3>Truy cập bị từ chối</h3>
    <p>Bạn không có quyền truy cập. Liên hệ Admin để được cấp quyền.</p>
    <button id="closeNoAccessModal">OK</button>
  </div>
</div>



  </main>

  <script type="module" src="script.js"></script>
    <script>


   function showModal(message) {
  const modal = document.getElementById("modalBox");
  document.getElementById("modalMessage").textContent = message;
  modal.classList.remove("hidden");
  document.getElementById("modalClose").onclick = () => {
    modal.classList.add("hidden");
  };
}

function confirmModal(message) {
  return new Promise((resolve) => {
    const modal = document.getElementById("confirmBox");
    document.getElementById("confirmMessage").textContent = message;
    modal.classList.remove("hidden");

    const yesBtn = document.getElementById("confirmYes");
    const noBtn = document.getElementById("confirmNo");

    yesBtn.onclick = () => {
      modal.classList.add("hidden");
      resolve(true);
    };
    noBtn.onclick = () => {
      modal.classList.add("hidden");
      resolve(false);
    };
  });
}


  </script>

</body>

</html>
